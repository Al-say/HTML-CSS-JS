name: GitHub Pages Deploy

on:
  push:
    branches: [ master ]
  workflow_dispatch:

jobs:
  build-and-deploy:
    runs-on: ubuntu-latest
    permissions:
      contents: write
      pages: write
    steps:
      - name: Debug Info
        run: |
          echo "ğŸ” Workspace: $GITHUB_WORKSPACE"
          echo "ğŸ“¦ Ref: $GITHUB_REF"
          echo "ğŸ“ SHA: $GITHUB_SHA"

      - name: Checkout Repository
        run: |
          # ç¡®ä¿å·¥ä½œç›®å½•å¹²å‡€
          rm -rf *
          # å…‹éš†ä»“åº“
          git clone https://github.com/Al-say/HTML-CSS-JS.git .
          # æ£€æŸ¥å…‹éš†ç»“æœ
          ls -la

      - name: Deploy to gh-pages
        run: |
          # é…ç½®git
          git config --global user.name "github-actions[bot]"
          git config --global user.email "github-actions[bot]@users.noreply.github.com"
          
          # åˆ›å»ºæ–°çš„gh-pagesåˆ†æ”¯
          git checkout --orphan gh-pages
          git reset --hard
          
          # æ·»åŠ æ‰€æœ‰æ–‡ä»¶
          git add .
          git status
          
          # æäº¤æ›´æ”¹
          git commit -m "Deploy to GitHub Pages"
          
          # æ¨é€åˆ°gh-pagesåˆ†æ”¯
          git push -f https://x-access-token:${{ secrets.GITHUB_TOKEN }}@github.com/Al-say/HTML-CSS-JS.git gh-pages
